jQuery(document).ready(function(){survey_form.init()});survey_form=function(){return{new_question_id:"",init:function(){survey_form.addEvents(jQuery("body"))},addEvents:function(a){a.find(".survey-add-new").click(function(){survey_form.addNewSurveyQuestionEvents(jQuery(this))});a.find(".survey-add-existing").click(function(){survey_form.addExistingSurveyQuestionEvents(jQuery(this))});a.find(".save-survey").click(function(){survey_form.saveNewSurvey(jQuery(this))});a.find(".show-survey-form").click(function(){survey_form.loadSurveyForm("",0)});return a},addNewSurveyQuestionEvents:function(c){var d={type:"new"};var a=c.closest("form").find(".survey_id").val();if(typeof a==="undefined"||!a){survey_form.saveNewSurvey(c);return false}var b=kazist.callAjaxByRoute("surveys.questions.ajaxloadquestionform",d,true);jQuery(".survey-question-form").html(b);question_form.addEvents(jQuery(".survey-question-form"))},addExistingSurveyQuestionEvents:function(c){var d={type:"existing"};var a=c.closest("form").find(".survey_id").val();if(typeof a==="undefined"||!a){survey_form.saveNewSurvey(c);return false}var b=kazist.callAjaxByRoute("surveys.questions.ajaxloadquestionform",d,true);jQuery(".survey-question-form").html(b);question_form.addEvents(jQuery(".survey-question-form"))},saveNewSurvey:function(f){var h="Validation Error";var e="<b>Survey Must be Saved First before Adding Questions.</b>";var b=true;var a=f.closest("form").find("#survey_id").val();var d=f.closest("form").find("#title").val();var c=f.closest("form").find("#description").val();if(d===""){b=false;e+="<br>Survey Title is a required Fields and can not be empty."}if(c===""||c===" "||c==="  "||c==="  "){b=false;e+="<br>Description is a required Fields and can not be empty."}if(b){data={};data=kazist.createNestedObject(data,["form[id]"],a);data=kazist.createNestedObject(data,["form[title]"],d);data=kazist.createNestedObject(data,["form[description]"],c);var g=kazist.callAjaxByRoute("surveys.surveys.ajaxsavesurvey",data,true);if(typeof g.survey_id!="undefined"){survey_form.loadSurveyForm(g.survey_id,0)}}else{kazist.showDialog(h,e,"error")}},loadSurveyForm:function(a,c){var d={survey_id:a,hide_on_new:c};var b=kazist.callAjaxByRoute("surveys.surveys.ajaxloadsurveyform",d,true);jQuery(".survey-form").html(b);jQuery("#survey_id").val(a);survey_form.addEvents(jQuery(".survey-form"));question_form.addEvents(jQuery(".survey-form"))}}}();