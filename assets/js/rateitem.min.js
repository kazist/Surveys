jQuery(document).ready(function(){rate_form.init()});rate_form=function(){return{init:function(){rate_form.addEvents(jQuery("body"))},addEvents:function(a){a.find(".survey-rate-item").click(function(){if(!jQuery(".survey-rate-rated").length){rate_form.submitItemRatings(jQuery(this))}else{title="You can only rate once.";message="You can only rate this article once. Repeated rating is ignored.";kazist.showDialog(title,message,"error")}return});return a},submitItemRatings:function(e){var d=e.attr("option_id");var h=e.closest(".survey-rate").attr("rate_id");var b=e.closest(".survey-rate").attr("app_id");var c=e.closest(".survey-rate").attr("com_id");var g=e.closest(".survey-rate").attr("subset_id");var a=e.closest(".cms-content").find("#id").val();var f={item_id:a,rate_id:h,option_id:d,app_id:b,com_id:c,subset_id:g};kazist.callAjaxByRoute("surveys.rates.ajaxsaverate",f,true);rate_form.updateSurvey(a,h,b,c,g)},updateSurvey:function(b,g,a,c,f){var e={item_id:b,rate_id:g,app_id:a,com_id:c,subset_id:f};var d=kazist.callAjaxByRoute("surveys.rates.ajaxloadrate",e,true);jQuery(".survey-rate").replaceWith(d);rate_form.addEvents(jQuery(".survey-rate"))}}}();